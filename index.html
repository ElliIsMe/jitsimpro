<html>
<head>
<meta charset="utf-8">
<script src='https://meet.jit.si/external_api.js'></script>
<title>www.jitsimprov.de</title>
<style> 
input, textarea {background:#F7E3FD}
textarea{height:180px; width: 102px}
</style>
</head>
<body>
<h1>Jitsimpro</h1>
<div id="hidebutton">
<input type="text" placeholer="Raumname" id="roomname">
<img src="Connect-Button.png" onclick="connect()">
</div>
<img src="Los-Button.png" onclick="ausgabe()" id="Los-BUTTON" style="display:none"> 
<p id="ausgabenamen"></p>
<div id="meet"></div>
<script>

function connect (){
	roomname=document.querySelector('#roomname').value
	if(roomname==="") {roomname= "jhhh2021betahauswscat"}
	console.log("blinry", roomname)
	const domain = 'meet.jit.si';
	//const domain = 'meet02.verstehbahnhof.de';
	const options = {
		roomName: roomname,
		width: 700,
		height: 700,
		parentNode: document.querySelector('#meet'),
		configOverwrite: { startWithAudioMuted: true },
	
	};
	api = new JitsiMeetExternalAPI(domain, options);
	document.querySelector('#hidebutton').style.display="none"
	document.querySelector('#Los-BUTTON').style.display="block"
}



berufe=["Bäcker*in", "Briefmarkenhändler*in", "Zahnärzt*in", "Florist*in", "Kellner*in"]
objekte=["Tisch", "Gummiente", "Headset", "Franzbrötchen", "Mate", "Alpakas", "Schloss", "Zahn", "Blatt", "Besen", "Staubsauger", "Feuerzeug", "Baby", "Kerze"]
function ausgabe (){
	participants=api.getParticipantsInfo()
	names=participants.map(o=>o.displayName)
	console.log(names)
	namelist= names
	if(namelist.length < 2){
		alert ("Mindestanzahl Personen: 2")
		return
	}
	do{
		namenumber=getRandomInt(namelist.length)
		name=namelist[namenumber]
		namenumber2=getRandomInt(namelist.length)
		name2=namelist[namenumber2]
	}while (namenumber===namenumber2)
	berufnummer=getRandomInt(berufe.length)
	beruf=berufe[berufnummer]
	objektnummer=getRandomInt(objekte.length)
	objekt=objekte[objektnummer]
	message=`${name} (Beruf: ${beruf}) und ${name2} (Objekt: ${objekt})` 
	document.querySelector("#ausgabenamen").innerHTML=message
	api.executeCommand('sendChatMessage',
    		message 
	);
}
function getRandomInt(max) {
  return Math.floor(Math.random() * max);
}

</script>
</body>
</html>
